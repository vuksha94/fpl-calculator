(this["webpackJsonptemperature-calculator"]=this["webpackJsonptemperature-calculator"]||[]).push([[0],{31:function(e,t,a){},54:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(3),s=a.n(r),c=a(21),i=a.n(c),l=(a(31),a(32),a(33),a(7)),o=a.n(l);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var u=a(6),d=a.n(u),h=a(10),j=a(11),b=a(4),p=a(1),f=a(22),g=a(25),y=a(24),v=a(12),O=a(23),m=a.n(O);function x(e,t,a){return new Promise((function(n){m()({method:t,url:e,data:JSON.stringify(a)}).then((function(e){return function(e,t){var a={status:"success",data:e.data};return t(a)}(e,n)})).catch((function(e){n({status:"error",data:{}})}))}))}function I(e){return Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsxs)("label",{children:[e.description,":"]}),Object(n.jsxs)("select",{className:"form-control",onChange:function(t){return e.onSelectChange(t.target.value)},value:e.value,children:[Object(n.jsx)("option",{value:"",children:e.defaultText}),e.options.map((function(e){return Object(n.jsx)("option",{value:e.value,children:e.text},e.value)}))]})]})}function C(e){var t,a,r,s,c,i;return Object(n.jsx)("div",{id:"playerInfoModal",className:"modal fade",role:"dialog",children:Object(n.jsx)("div",{className:"modal-dialog",children:Object(n.jsxs)("div",{className:"modal-content",children:[Object(n.jsx)("div",{className:"modal-body",children:Object(n.jsxs)("table",{className:"table table-bordered",children:[Object(n.jsx)("thead",{children:Object(n.jsxs)("tr",{children:[Object(n.jsx)("th",{children:"Name"}),Object(n.jsx)("th",{children:"Goals"}),Object(n.jsx)("th",{children:"Assists"}),Object(n.jsx)("th",{children:"Minutes"}),Object(n.jsx)("th",{children:"Percentage"})]})}),Object(n.jsx)("tbody",{children:Object(n.jsxs)("tr",{children:[Object(n.jsx)("th",{children:(null===(t=e.player)||void 0===t?void 0:t.first_name)+" "+(null===(a=e.player)||void 0===a?void 0:a.second_name)}),Object(n.jsx)("th",{children:null===(r=e.player)||void 0===r?void 0:r.goals_scored}),Object(n.jsx)("th",{children:null===(s=e.player)||void 0===s?void 0:s.assists}),Object(n.jsx)("th",{children:null===(c=e.player)||void 0===c?void 0:c.minutes}),Object(n.jsxs)("th",{children:[null===(i=e.player)||void 0===i?void 0:i.percentageXI,"%"]})]})})]})}),Object(n.jsx)("div",{className:"modal-footer",children:Object(n.jsx)("button",{type:"button",className:"btn btn-default","data-dismiss":"modal",children:"Close"})})]})})})}function P(){return Object(n.jsx)("div",{className:"loader"})}var S=function e(t){Object(v.a)(this,e),this.entry=void 0,this.entry=t},k=function(e){Object(g.a)(a,e);var t=Object(y.a)(a);function a(e){var r;return Object(v.a)(this,a),(r=t.call(this,e)).playerRowClicked=function(e){r.setPlayerInfoClickedInState(e),o()("#playerInfoModal").modal("show")},r.printPlayerXIRow=function(e,t,a){return Object(n.jsxs)("tr",{onClick:function(){return r.playerRowClicked(e)},children:[Object(n.jsxs)("td",{children:[t+1,"."]}),Object(n.jsx)("td",{children:e.web_name}),Object(n.jsxs)("td",{children:[e.percentageXI,"%"]}),Object(n.jsx)("td",{children:e.countXI})]},e.id)},r.printPlayerCaptainRow=function(e,t,a){return Object(n.jsxs)("tr",{onClick:function(){return r.playerRowClicked(e)},children:[Object(n.jsxs)("td",{children:[t+1,"."]}),Object(n.jsx)("td",{children:e.web_name}),Object(n.jsxs)("td",{children:[e.percentageCaptain,"%"]}),Object(n.jsx)("td",{children:e.countCaptain})]},e.id)},r.selectValueChanged=function(e){r.setNumberOfManagersInState(Number(e))},r.leagueCodeChanged=function(e){r.setLeagueCodeInState(Number(e))},r.state={allPlayersInfo:[],managers:[],playersXICountMap:new Map,playersSubCountMap:new Map,playersCaptainCountMap:new Map,playersXIPercentageArray:[],playersSubPercentageArray:[],playersCaptainPercentageArray:[],loading:!1,serverError:!1,numberOfManagers:100,leagueCode:64284,loadingFullness:0},r}return Object(f.a)(a,[{key:"componentDidMount",value:function(){}},{key:"resetData",value:function(){this.setState((function(e){return Object.assign(Object(p.a)({},e),{managers:[],playersCountMap:new Map,playersPercentageArray:[],serverError:!1,loadingFullness:0})}))}},{key:"getData",value:function(){var e=this;this.resetData(),console.log("getData()"),this.setLoadingState(!0),this.getAllPlayersAndGWInfo().then((function(t){console.log("getAllPlayersAndGWInfo response"),e.setAllPlayersInfoInState(t.players),e.setCurrentGWInState(t.currentGW)})),this.getListOfManagers().then((function(t){return e.setManagersInState(t),console.log(t),e.getListOfPlayers(t)})).then((function(t){e.setPlayersCountsInfoInMaps(t),console.log(e.state.playersXICountMap),console.log(e.state.playersSubCountMap),console.log(e.state.playersCaptainCountMap),e.calculatePercentage(),e.setLoadingState(!1)})),console.log("getData() end")}},{key:"calculatePercentage",value:function(){var e=this,t=[],a=[];this.state.playersXICountMap.forEach((function(a,n){var r=a/e.state.managers.length*100;r=Number(r.toFixed(2));var s=e.state.allPlayersInfo.find((function(e){return e.id===n}));s.percentageXI=r,s.countXI=a,t=[].concat(Object(b.a)(t),[s])}));var n=t.sort((function(e,t){return t.percentageXI-e.percentageXI}));this.setPlayersXISorted("desc"),this.setPlayersXIPercentageArray(n),this.state.playersCaptainCountMap.forEach((function(t,n){var r=t/e.state.managers.length*100;r=Number(r.toFixed(2));var s=e.state.allPlayersInfo.find((function(e){return e.id===n}));s.percentageCaptain=r,s.countCaptain=t,a=[].concat(Object(b.a)(a),[s])}));var r=a.sort((function(e,t){return t.percentageCaptain-e.percentageCaptain}));this.setPlayersCaptainPercentageArray(r)}},{key:"getAllPlayersAndGWInfo",value:function(){var e=this;return new Promise((function(t){x("bootstrap-static/","get").then((function(a){if("success"===a.status){var n=a.data.elements,r=a.data.events.find((function(e){return e.is_current})).id;return t({players:n,currentGW:r})}e.setServerError(!0)}))}))}},{key:"getListOfPlayers",value:function(){var e=Object(j.a)(d.a.mark((function e(t){var a,n,r,s,c=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.state.currentGW,n=[],r=[],s=[],console.log("managers start"),e.abrupt("return",new Promise((function(e){var i=[];for(var l in t){var o="/entry/".concat(t[l].entry,"/event/").concat(a,"/picks/");i.push(o)}for(var u=[],d=0;d<i.length;++d)u.push(x(i[d],"get"));Promise.all(u).then((function(t){var a,i=Object(h.a)(t);try{for(i.s();!(a=i.n()).done;){var l=a.value;if("success"===l.status){var o=l.data.picks;for(var u in o){var d=o[u];Number(u)<11?n=[].concat(Object(b.a)(n),[d.element]):r=[].concat(Object(b.a)(r),[d.element]),d.is_captain&&(s=[].concat(Object(b.a)(s),[d.element]))}}else c.setServerError(!0)}}catch(j){i.e(j)}finally{i.f()}e({playersXIIds:n,playersSUBIds:r,playersCaptainsIds:s})}))})));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getListOfManagers",value:function(){var e=Object(j.a)(d.a.mark((function e(){var t,a,n,r,s,c,i,l,o,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Math.ceil(this.state.numberOfManagers/50),a=this.state.numberOfManagers%50,n=this.state.leagueCode,r=[],s=1;case 5:if(!(s<=t)){e.next=30;break}return c="leagues-classic/".concat(n,"/standings/?page_standings=").concat(s),e.next=9,x(c,"get");case 9:if("success"!==(i=e.sent).status){e.next=26;break}console.log(i.data),l=i.data.standings.results,o=1;case 14:if(!(o<=l.length)){e.next=22;break}if(t!==s||0===a||a!==o-1){e.next=17;break}return e.abrupt("break",22);case 17:u=l[o-1].entry,r=[].concat(Object(b.a)(r),[new S(u)]);case 19:o++,e.next=14;break;case 22:if(i.data.standings.has_next){e.next=24;break}return e.abrupt("break",30);case 24:e.next=27;break;case 26:return e.abrupt("return",Promise.resolve([]));case 27:++s,e.next=5;break;case 30:return e.abrupt("return",Promise.resolve(r));case 31:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setPlayersXISorted",value:function(e){this.setState((function(t){return Object.assign(Object(p.a)({},t),{playersXISorted:e})}))}},{key:"setPlayersXIPercentageArray",value:function(e){this.setState((function(t){return Object.assign(Object(p.a)({},t),{playersXIPercentageArray:e})}))}},{key:"setPlayersCaptainPercentageArray",value:function(e){this.setState((function(t){return Object.assign(Object(p.a)({},t),{playersCaptainPercentageArray:e})}))}},{key:"makeMap",value:function(e){var t,a=new Map,n=Object(h.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(a.has(r)){var s=a.get(r);a.set(r,s+1)}else a.set(r,1)}}catch(c){n.e(c)}finally{n.f()}return a}},{key:"setPlayersCountsInfoInMaps",value:function(e){var t=this.makeMap(null===e||void 0===e?void 0:e.playersXIIds),a=this.makeMap(null===e||void 0===e?void 0:e.playersSUBIds),n=this.makeMap(null===e||void 0===e?void 0:e.playersCaptainsIds);this.setPlayersXICountMap(t),this.setPlayersSubCountMap(a),this.setPlayersCaptainCountMap(n)}},{key:"setPlayersXICountMap",value:function(e){this.setState((function(t){return Object.assign(Object(p.a)({},t),{playersXICountMap:e})}))}},{key:"setPlayersSubCountMap",value:function(e){this.setState((function(t){return Object.assign(Object(p.a)({},t),{playersSubCountMap:e})}))}},{key:"setPlayersCaptainCountMap",value:function(e){this.setState((function(t){return Object.assign(Object(p.a)({},t),{playersCaptainCountMap:e})}))}},{key:"setLoadingState",value:function(e){this.setState((function(t){return Object.assign(Object(p.a)({},t),{loading:e})}))}},{key:"setServerError",value:function(e){this.setState((function(t){return Object.assign(Object(p.a)({},t),{serverError:e})}))}},{key:"setAllPlayersInfoInState",value:function(e){this.setState((function(t){return Object.assign(Object(p.a)({},t),{allPlayersInfo:e})}))}},{key:"setManagersInState",value:function(e){this.setState((function(t){return Object.assign(Object(p.a)({},t),{managers:e})}))}},{key:"setNumberOfManagersInState",value:function(e){this.setState((function(t){return Object.assign(Object(p.a)({},t),{numberOfManagers:e})}))}},{key:"setLeagueCodeInState",value:function(e){this.setState((function(t){return Object.assign(Object(p.a)({},t),{leagueCode:e})}))}},{key:"setCurrentGWInState",value:function(e){this.setState((function(t){return Object.assign(Object(p.a)({},t),{currentGW:e})}))}},{key:"setLoadingFullnessInState",value:function(e){this.setState((function(t){return Object.assign(Object(p.a)({},t),{loadingFullness:e})}))}},{key:"setPlayerInfoClickedInState",value:function(e){this.setState((function(t){return Object.assign(Object(p.a)({},t),{playerInfoClicked:e})}))}},{key:"printServerErrorMsg",value:function(){alert("Server error occured. Data may be invalid."),this.setServerError(!1)}},{key:"toggleSortStartXI",value:function(){var e=[];"desc"===this.state.playersXISorted?(e=this.state.playersXIPercentageArray.sort((function(e,t){return e.percentageXI-t.percentageXI})),this.setPlayersXISorted("asc")):(e=this.state.playersXIPercentageArray.sort((function(e,t){return t.percentageXI-e.percentageXI})),this.setPlayersXISorted("desc")),this.setPlayersXIPercentageArray(e)}},{key:"printPlayersPercentage",value:function(){var e=this;if(this.state.playersXIPercentageArray.length)return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("div",{className:"col-sm-6",children:Object(n.jsxs)("table",{className:"table table-bordered",children:[Object(n.jsxs)("thead",{children:[Object(n.jsx)("tr",{children:Object(n.jsx)("th",{colSpan:4,children:"Starting XI"})}),Object(n.jsxs)("tr",{children:[Object(n.jsx)("th",{className:"cursor-pointer",onClick:function(){return e.toggleSortStartXI()},scope:"col",children:"#"}),Object(n.jsx)("th",{scope:"col",children:"Player"}),Object(n.jsx)("th",{scope:"col",children:"Percentage"}),Object(n.jsx)("th",{scope:"col",children:"Count"})]})]}),Object(n.jsx)("tbody",{children:this.state.playersXIPercentageArray.map(this.printPlayerXIRow)})]})}),Object(n.jsx)("div",{className:"col-sm-6",children:Object(n.jsxs)("table",{className:"table table-bordered",children:[Object(n.jsxs)("thead",{children:[Object(n.jsx)("tr",{children:Object(n.jsx)("th",{colSpan:4,children:"Captains"})}),Object(n.jsxs)("tr",{children:[Object(n.jsx)("th",{scope:"col",children:"#"}),Object(n.jsx)("th",{scope:"col",children:"Player"}),Object(n.jsx)("th",{scope:"col",children:"Percentage"}),Object(n.jsx)("th",{scope:"col",children:"CNT"})]})]}),Object(n.jsx)("tbody",{children:this.state.playersCaptainPercentageArray.map(this.printPlayerCaptainRow)})]})})]})}},{key:"printLoadingBar",value:function(){return Object(n.jsx)("div",{className:"col-sm-12 loader-col",children:Object(n.jsx)(P,{})})}},{key:"render",value:function(){var e=this,t=this.state.managers.length;return Object(n.jsxs)("div",{className:"container-fluid",children:[Object(n.jsx)("div",{className:"row",children:Object(n.jsx)(I,{onSelectChange:this.selectValueChanged,defaultText:"Select",options:[{value:5,text:"TOP 5"},{value:10,text:"TOP 10"},{value:100,text:"TOP 100"}],value:this.state.numberOfManagers,description:"Sample"})}),Object(n.jsx)("div",{className:"row",children:Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{children:"League code:"}),Object(n.jsx)("input",{className:"form-control",type:"number",value:this.state.leagueCode,onChange:function(t){return e.leagueCodeChanged(t.target.value)},required:!0})]})}),Object(n.jsx)("div",{className:"row",children:Object(n.jsx)("button",{className:"btn btn-info",disabled:this.state.loading,onClick:function(){return e.getData()},children:"Calculate percentage"})}),Object(n.jsx)("div",{className:"row",children:Object(n.jsx)("div",{className:"col-sm-12",children:!this.state.loading&&t>0&&Object(n.jsxs)("span",{className:"text-bold ",children:["Total number of managers:",t]})})}),Object(n.jsxs)("div",{className:"row",children:[this.state.serverError&&this.printServerErrorMsg(),!this.state.loading&&this.printPlayersPercentage(),this.state.loading&&this.printLoadingBar()]}),Object(n.jsx)(C,{player:this.state.playerInfoClicked})]})}}]),a}(s.a.Component);i.a.render(Object(n.jsx)(k,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[54,1,2]]]);
//# sourceMappingURL=main.e216210b.chunk.js.map